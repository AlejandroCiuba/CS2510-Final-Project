version: '3.1'
services:

  brokera:
    build: ${BROKER_DOCKER}
    hostname: brokera
    tty: true
    environment:
      NAME: brokera
      CLIENT: brokera:2379
      PEERS: brokera:2379
      INITIAL: brokera:2379
  command: bash -c "bash ${BROKER}"

  servera:
    build: ${SERVER_DOCKER}
    hostname: servera
    tty: true
    environment:
      SERVER: servera:20160
      ENDPOINT: brokera:2379
    command: bash -c "sleep 5; bash ${SERVER}"
    depends_on:
      - brokera

  client:
    build: ${CLIENT_DOCKER}
    hostname: client
    tty: true
    environment:
      BROKER: brokera:2379
    command: bash -c "sleep 10; bash ${CLIENT}"
    depends_on:
      - servera
